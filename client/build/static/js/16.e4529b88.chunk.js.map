{"version":3,"sources":["pages/PwdChange/index.js"],"names":["PwdChange","useState","show","setShow","formRef","useRef","id","useSelector","state","user","credentials","history","useHistory","handleSubmit","data","a","reset","schema","Yup","shape","password","required","oneOf","password2","validate","abortEarly","axios","put","status","toastr","success","push","console","log","errorMessages","inner","forEach","erro","path","message","current","setErrors","onCancel","size","onHide","centered","Header","closeButton","Title","Body","ref","onSubmit","type","name","label","md","className","variant","onClick"],"mappings":"wQA2FeA,UA/EG,WAAO,IAAD,EACCC,oBAAS,GADV,mBAChBC,EADgB,KACVC,EADU,KAGjBC,EAAUC,iBAAO,MAGPC,EACZC,uBAAY,SAACC,GAAD,OAAWA,EAAMC,KAAKA,QADrCC,YAAeJ,GAGVK,EAAUC,cAEVC,EAAY,uCAAG,WAAOC,EAAP,oBAAAC,EAAA,+DAAeC,MAAf,SAEbC,EAASC,MAAaC,MAAM,CACjCC,SAAUF,MACRG,SAAS,sBACTC,MAAM,CAACJ,IAAQ,aAAc,MAAO,2BACtCK,UAAWL,MAAaG,SAAS,wCANf,SAQbJ,EAAOO,SAASV,EAAM,CAAEW,YAAY,IARvB,gCAUKC,IAAMC,IAAN,iBAAoBrB,EAApB,eAAqCQ,GAV1C,OAWM,MAXN,OAWLc,SACZC,SAAOC,QAAQ,8BACf3B,GAAQ,GACRQ,EAAQoB,KAAK,sBAdI,kDAiBlBC,QAAQC,IAAR,MAjBkB,0DAoBf,gBAAiBf,MACdgB,EAAgB,GACtB,KAAMC,MAAMC,SAAQ,SAACC,GACpBH,EAAcG,EAAKC,MAAQD,EAAKE,QAChCnC,EAAQoC,QAAQC,UAAUP,OAxBT,iEAAH,wDA6BZQ,EAAW,WAChBvC,GAAQ,GACRQ,EAAQoB,KAAK,sBAGd,OACC,kBAAC,IAAD,CAAOY,KAAK,KAAKzC,KAAMA,EAAM0C,OAAQF,EAAUG,UAAQ,GACtD,kBAAC,IAAMC,OAAP,CAAcC,aAAW,GACxB,kBAAC,IAAMC,MAAP,uBAED,kBAAC,IAAMC,KAAP,KACC,kBAAC,IAAD,CAAMC,IAAK9C,EAAS+C,SAAUtC,GAC7B,kBAAC,IAAD,KACC,kBAAC,IAAD,KACC,kBAAC,IAAD,CAAOuC,KAAK,WAAWC,KAAK,WAAWC,MAAM,YAG/C,kBAAC,IAAD,KACC,kBAAC,IAAD,KACC,kBAAC,IAAD,CAAOF,KAAK,WAAWC,KAAK,YAAYC,MAAM,qBAIhD,kBAAC,IAAD,KACC,kBAAC,IAAD,CAAKC,GAAI,GAAIC,UAAU,cACtB,kBAAC,IAAD,CAAQJ,KAAK,SAASK,QAAQ,WAA9B,UAGA,kBAAC,IAAD,CAAQA,QAAQ,SAASC,QAAShB,GAAlC","file":"static/js/16.e4529b88.chunk.js","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useSelector } from 'react-redux';\nimport { toastr } from 'react-redux-toastr';\nimport { Row, Col, Button, Modal } from 'react-bootstrap';\nimport { FaKey } from 'react-icons/fa';\nimport { Form } from '@unform/web';\nimport { Input } from '../../components/common/Form';\nimport * as Yup from 'yup';\nimport { useHistory } from 'react-router-dom';\n\nimport axios from 'axios';\n\nconst PwdChange = () => {\n\tconst [show, setShow] = useState(true);\n\n\tconst formRef = useRef(null);\n\n\tconst {\n\t\tcredentials: { id },\n\t} = useSelector((state) => state.user.user);\n\n\tconst history = useHistory();\n\n\tconst handleSubmit = async (data, { reset }) => {\n\t\ttry {\n\t\t\tconst schema = Yup.object().shape({\n\t\t\t\tpassword: Yup.string()\n\t\t\t\t\t.required('Senha obrigatoria!')\n\t\t\t\t\t.oneOf([Yup.ref('password2'), null], 'Senhas não conferem!'),\n\t\t\t\tpassword2: Yup.string().required('Informe confirmação de senha'),\n\t\t\t});\n\t\t\tawait schema.validate(data, { abortEarly: false });\n\t\t\ttry {\n\t\t\t\tconst response = await axios.put(`/users/${id}/change_pwd`, data);\n\t\t\t\tif (response.status === 200) {\n\t\t\t\t\ttoastr.success('Senha alterada com sucesso');\n\t\t\t\t\tsetShow(false);\n\t\t\t\t\thistory.push('/inicio/principal');\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tconsole.log(error);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tif (error instanceof Yup.ValidationError) {\n\t\t\t\tconst errorMessages = {};\n\t\t\t\terror.inner.forEach((erro) => {\n\t\t\t\t\terrorMessages[erro.path] = erro.message;\n\t\t\t\t\tformRef.current.setErrors(errorMessages);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\tconst onCancel = () => {\n\t\tsetShow(false);\n\t\thistory.push('/inicio/principal');\n\t};\n\n\treturn (\n\t\t<Modal size=\"sm\" show={show} onHide={onCancel} centered>\n\t\t\t<Modal.Header closeButton>\n\t\t\t\t<Modal.Title>Alterar Senha</Modal.Title>\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Body>\n\t\t\t\t<Form ref={formRef} onSubmit={handleSubmit}>\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<Col>\n\t\t\t\t\t\t\t<Input type=\"password\" name=\"password\" label=\"Senha\" />\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Row>\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<Col>\n\t\t\t\t\t\t\t<Input type=\"password\" name=\"password2\" label=\"Confirma Senha\" />\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Row>\n\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<Col md={12} className=\"text-right\">\n\t\t\t\t\t\t\t<Button type=\"submit\" variant=\"primary\">\n\t\t\t\t\t\t\t\tSalvar\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t<Button variant=\"danger\" onClick={onCancel}>\n\t\t\t\t\t\t\t\tCancelar\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Row>\n\t\t\t\t</Form>\n\t\t\t</Modal.Body>\n\t\t</Modal>\n\t);\n};\n\nexport default PwdChange;\n"],"sourceRoot":""}